<!DOCTYPE html PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html>
  <head>
    <title>Route Delays</title>
    <link type="text/css" rel="stylesheet" href="elegant-aero.css" />
  </head>
  <body></body>
  <script>
    // AI DISCLAIMER: Gemini wrote code to fetch the data

    // 1. Fetch the first dataset immediately when the page loads
    fetch("/api/batch-data")
      .then((response) => response.json())
      .then((data) => {
        console.log("Batch data loaded:", data);
        // Call your D3 function to draw the first graph
        drawMainGraph(data);
      });

    let userStatsData = null; // Global variable to hold the data

    // Fetch the data immediately on page load
    fetch("/api/user-stats")
      .then((response) => response.json())
      .then((data) => {
        console.log("User Stats Loaded:", data);
        userStatsData = data;

        // OPTIONAL: If you want to draw this graph immediately, call your function here:
        // drawUserStatsGraph(userStatsData);
      })
      .catch((error) => console.error("Error loading user stats:", error));

    // 2. Fetch the second dataset.
    // You can either do this immediately in the background:
    /*
fetch('/api/speed-data')
  .then(response => response.json())
  .then(data => {
      console.log("Speed data loaded:", data);
      // Store this data in a global variable for later use
      window.speedData = data;
  });

// OR, specifically for scrollytelling, trigger it only when needed:
// (Pseudo-code for a scroll library like ScrollMagic or IntersectionObserver)
scroller.on('enter-last-section', function() {
    if (!window.speedData) {
         fetch('/api/speed-data').then(data => drawLastGraph(data));
    }
});
*/
  </script>
</html>
